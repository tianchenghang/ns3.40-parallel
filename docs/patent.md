# 发明专利申请

---

## 一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法及系统

---

### 技术领域

[0001] 本发明涉及计算机网络技术领域，尤其涉及一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法及系统。

---

### 背景技术

[0002] 随着云计算、大数据、人工智能和物联网技术的快速发展，数据中心网络的规模和复杂度呈指数级增长，网络流量持续爆发。据统计，全球数据中心网络流量以年均 25% 以上的速度增长，预计到 2025 年将超过 20 ZB。传输控制协议（Transmission Control Protocol，TCP）作为互联网传输层的核心协议，承载了超过 90% 的数据中心网络流量，其拥塞控制机制的性能直接影响网络资源利用效率、应用响应延迟和用户服务质量。

[0003] 传统的 TCP 拥塞控制算法主要分为两类：基于丢包的拥塞控制算法和基于延迟的拥塞控制算法。

[0004] 基于丢包的拥塞控制算法（如 TCP NewReno、TCP CUBIC 等）将数据包丢失作为网络拥塞的主要判断信号。TCP NewReno 采用加性增乘性减（Additive Increase Multiplicative Decrease，AIMD）策略，在无丢包时线性增加拥塞窗口，检测到丢包时将窗口减半。TCP CUBIC 采用三次函数模型调整窗口大小，提高了高带宽延迟积网络中的收敛速度。这类算法的优点是实现简单、鲁棒性强，已被广泛部署。然而，基于丢包的算法存在以下固有缺陷：

[0005] 第一，丢包是拥塞的滞后信号。网络设备的缓冲区在溢出丢包前已经积累了大量排队数据，导致传输延迟显著增加。研究表明，在典型数据中心网络中，基于丢包算法的平均排队延迟可达数毫秒至数十毫秒，远超过网络本身的传播延迟。

[0006] 第二，在高带宽延迟积（Bandwidth-Delay Product，BDP）网络中，算法收敛速度慢。以 10Gbps 带宽、100 微秒往返延迟的数据中心链路为例，其 BDP 约为 125KB，而 TCP CUBIC 需要数百个往返时间才能探测到可用带宽，导致链路利用率低下。

[0007] 第三，缺乏对网络拥塞程度的精细感知，无法区分轻度拥塞和严重拥塞，只能采用统一的窗口缩减策略，影响吞吐量性能。

[0008] 基于延迟的拥塞控制算法（如 TCP Vegas、BBR 等）通过监测往返时延（Round-Trip Time，RTT）的变化来推断网络拥塞状态。TCP Vegas 基于期望吞吐量和实际吞吐量的差值调整发送速率。Google 提出的 BBR 算法通过显式估计瓶颈带宽和最小 RTT，以带宽延迟积为目标调整发送速率。这类算法能够在丢包发生前感知拥塞，具有较低的排队延迟。然而，基于延迟的算法也存在不足：

[0009] 第一，RTT 测量容易受到多种因素干扰，包括操作系统调度延迟、网络抖动、路径变化等，导致算法稳定性较差。

[0010] 第二，在与基于丢包算法共存时存在公平性问题。由于基于延迟算法对拥塞信号更敏感，会提前降低发送速率，在带宽竞争中处于劣势。实验表明，在与 CUBIC 流共存时，BBR 流的吞吐量可能下降 30% 以上。

[0011] 第三，对于突发流量和路径变化的适应性有限，参数调整依赖于预设的固定值，难以适应动态变化的网络环境。

[0012] 显式拥塞通知（Explicit Congestion Notification，ECN）是一种网络层辅助机制，由 RFC 3168 定义。ECN 允许网络设备在队列长度超过阈值时，在 IP 报头的拥塞经历（Congestion Experienced，CE）字段进行标记，而不是直接丢弃数据包。接收端通过 TCP 报头的 ECN-Echo（ECE）标志将拥塞信息反馈给发送端，发送端据此调整发送速率。ECN 机制具有以下优势：

[0013] 第一，ECN 能够在丢包发生前提供拥塞信号，使发送端能够提前采取措施避免拥塞恶化。

[0014] 第二，ECN 避免了因丢包导致的重传开销，提高了网络效率。

[0015] 第三，ECN 信号来自网络设备的显式标记，比推测性的 RTT 测量更加可靠。

[0016] 然而，现有拥塞控制算法对 ECN 的利用不够充分。大多数算法将 ECN 视为等同于丢包的信号进行处理，采用相同的窗口缩减策略。数据中心 TCP（Data Center TCP，DCTCP）虽然利用 ECN 标记比例进行细粒度调整，但其参数为静态预设，缺乏对网络环境变化的自适应能力。

[0017] 近年来，机器学习技术的发展为网络拥塞控制带来了新的思路。强化学习是一种通过与环境交互来学习最优策略的机器学习方法，智能体（Agent）通过观察环境状态、执行动作并获得奖励来不断优化决策策略。将强化学习应用于拥塞控制具有以下潜在优势：

[0018] 第一，强化学习能够自适应地学习网络环境特征，无需人工设计复杂的控制规则，可以发现人类专家难以设计的优化策略。

[0019] 第二，强化学习能够综合利用多种拥塞信号，通过特征融合实现更精确的拥塞检测和响应。

[0020] 第三，强化学习能够根据网络条件动态调整控制参数，实现参数的在线自适应优化。

[0021] 然而，现有基于强化学习的拥塞控制方案存在以下问题：

[0022] 第一，状态空间设计不完善。现有方案通常只使用有限的状态参数（如 RTT、吞吐量），未能充分利用 TCP 协议栈提供的丰富状态信息，特别是 ECN 相关状态和拥塞控制事件信息，导致智能体难以准确感知网络状态。

[0023] 第二，奖励函数设计不合理。简单的奖励函数难以平衡吞吐量、延迟、公平性等多个优化目标，导致学习到的策略在某些场景下性能不佳。

[0024] 第三，缺乏对 ECN 信号的分级利用。现有方案未能区分 ECN 触发的拥塞响应和实际丢包触发的拥塞响应，采用统一的处理策略，无法充分发挥 ECN 作为早期预警信号的优势。

[0025] 第四，算法验证效率低下。传统的算法验证依赖于真实网络环境或简单的仿真模型，存在成本高、周期长、可重复性差、场景覆盖不全等问题。高保真网络仿真虽然能够提供真实的协议行为，但单线程架构限制了大规模仿真的效率。

[0026] 因此，需要一种新的技术方案，能够充分利用多种拥塞信号进行融合检测，实现控制参数的自适应调优，并通过高效的并行化仿真平台进行算法训练和验证，以实现更优的网络拥塞控制性能。

---

### 发明内容

[0027] 本发明的目的在于提供一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法及系统，以解决现有技术中拥塞控制算法对多种拥塞信号利用不充分、参数自适应能力差、验证效率低等问题。

[0028] 为实现上述目的，本发明第一方面提供一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法，包括以下步骤：

[0029] S1、构建多维网络状态观测空间，从 TCP 协议栈采集包含 15 个参数的状态向量，所述参数涵盖连接标识、时间信息、窗口状态、传输指标、延迟测量、回调类型、拥塞状态和显式拥塞通知状态；

[0030] S2、基于所述多维状态参数，执行多信号融合拥塞检测，综合分析丢包信号、显式拥塞通知信号、往返时延膨胀信号、拥塞控制状态信号和拥塞事件信号，判断网络拥塞状态并量化拥塞严重程度；

[0031] S3、根据拥塞检测结果和历史性能数据，执行自适应参数调优，动态调整乘性增加因子和加性增加因子，实现控制策略对网络环境的实时适配；

[0032] S4、采用融合控制策略计算目标拥塞窗口大小，所述融合控制策略将基于带宽延迟积的速率控制与基于当前窗口的保守控制相结合，根据拥塞类型采用差异化的窗口调整策略；

[0033] S5、输出新的慢启动阈值和拥塞窗口大小，更新 TCP 连接的传输参数。

[0034] 进一步地，所述步骤 S1 中，多维网络状态观测空间包含以下 15 个参数：

[0035] 参数 0：套接字唯一标识符，用于区分不同的 TCP 连接，支持多流并发场景下的独立状态管理；

[0036] 参数 1：环境类型标识，区分事件驱动模式和时间驱动模式，事件驱动模式下该值为 0；

[0037] 参数 2：仿真时间，表示当前时刻的仿真时间戳，单位为微秒，用于计算时间间隔和事件频率；

[0038] 参数 3：节点标识符，表示 TCP 连接所在节点的唯一标识；

[0039] 参数 4：慢启动阈值，表示当前慢启动阈值，单位为字节，用于判断是否处于慢启动阶段；

[0040] 参数 5：当前拥塞窗口大小，表示当前允许发送的最大数据量，单位为字节；

[0041] 参数 6：TCP 段大小，表示最大报文段大小，单位为字节，用于窗口增量计算；

[0042] 参数 7：已确认段数量，表示本次确认事件中被确认的报文段数量，用于窗口增长计算；

[0043] 参数 8：在途字节数，表示已发送但尚未确认的数据量，单位为字节，用于计算管道利用率；

[0044] 参数 9：最近往返时延，表示最近一次测量的往返时延，单位为微秒；

[0045] 参数 10：最小往返时延，表示连接建立以来观测到的最小往返时延，单位为微秒，用于带宽延迟积估算和延迟膨胀计算；

[0046] 参数 11：调用函数类型，区分两种回调场景，值为 0 表示慢启动阈值获取回调（对应丢包事件），值为 1 表示窗口增加回调（对应正常确认事件）；

[0047] 参数 12：拥塞算法状态，表示 TCP 拥塞控制有限状态机的当前状态，包括开放状态、无序状态、拥塞窗口缩减状态、恢复状态和丢失状态；

[0048] 参数 13：拥塞算法事件，表示触发状态转换的事件类型，包括传输开始事件、拥塞窗口重启事件、拥塞窗口缩减完成事件、丢失事件、无拥塞经历标记事件、拥塞经历标记事件、延迟确认事件和非延迟确认事件；

[0049] 参数 14：显式拥塞通知状态，表示 ECN 机制的当前状态，包括禁用状态、空闲状态、收到拥塞经历标记状态、正在发送 ECN 回显状态、收到 ECN 回显状态和已发送拥塞窗口缩减标志状态。

[0050] 进一步地，所述步骤 S2 中，多信号融合拥塞检测采用分层优先级机制，具体包括：

[0051] S21、第一优先级信号检测：检测显式丢包信号。当调用函数类型为 0（慢启动阈值获取）时，判定检测到明确的丢包事件，设置拥塞标志为真，拥塞类型为丢包类型，拥塞严重程度为 0.7。丢包是最明确的拥塞信号，但采用适度的严重程度值以保留更多窗口、加速恢复；

[0052] S22、第二优先级信号检测：检测高频 ECN 信号。当显式拥塞通知状态为收到拥塞经历标记状态，或拥塞算法事件为拥塞经历标记事件时，进一步检查 ECN 事件频率。若 ECN 率超过预设阈值（每秒 30 次），判定发生持续性拥塞，设置拥塞标志为真，拥塞类型为 ECN 类型，拥塞严重程度为 0.3。低频 ECN 事件被视为瞬态现象，不触发拥塞响应；

[0053] S23、第三优先级信号检测：检测拥塞算法丢失状态。当拥塞算法状态为丢失状态时，表示发生了超时丢包，网络路径严重受损。设置拥塞标志为真，拥塞类型为丢失状态类型，拥塞严重程度为 0.6；

[0054] S24、若上述信号均未触发，判定当前网络未处于拥塞状态，返回非拥塞状态。

[0055] 进一步地，所述步骤 S2 中，对于非优先响应的拥塞信号采用吞吐量优先策略，具体包括：

[0056] 单次 ECN 信号处理：当检测到单次 ECN 事件但 ECN 率未超过阈值时，仅记录事件不触发窗口缩减，避免对瞬态拥塞的过度响应；

[0057] ECN 回显信号处理：ECN 回显状态表示接收端已反馈拥塞信息，但该信息已在高频 ECN 检测中处理，不重复响应；

[0058] 拥塞窗口缩减状态处理：该状态表示正在执行 ECN 响应，属于正常流程，不额外触发窗口缩减；

[0059] 恢复状态处理：快速恢复阶段由 TCP 协议栈管理，不干预其正常流程；

[0060] 往返时延膨胀处理：不将 RTT 膨胀作为拥塞触发条件，避免因测量噪声导致的误判，提高吞吐量稳定性。

[0061] 进一步地，所述步骤 S3 中，自适应参数调优采用多因素综合调整机制，对乘性增加因子的调整包括：

[0062] S31、基于 RTT 膨胀比的调整：计算 RTT 膨胀比为最近往返时延除以最小往返时延。当 RTT 膨胀比小于 1.5 时，网络具有充足容量，增大乘性增加因子 0.05 个单位，并累加连续增长计数；当 RTT 膨胀比在 1.5 至 2.0 之间时，存在轻度排队，增大乘性增加因子 0.02 个单位；当 RTT 膨胀比大于 3.0 时，存在严重排队，减小乘性增加因子 0.01 个单位，并重置连续增长计数；当 RTT 膨胀比在 2.0 至 3.0 之间时，保持乘性增加因子不变；

[0063] S32、基于 ECN 反馈的调整：当检测到 ECN 拥塞经历标记或 ECN 回显状态时，减小乘性增加因子 0.01 个单位。ECN 是早期预警信号，采用温和的调整幅度；

[0064] S33、基于拥塞状态的调整：当拥塞算法状态为丢失状态时，减小乘性增加因子 0.01 个单位，并重置连续增长计数。对于拥塞窗口缩减状态和恢复状态，不进行额外调整以保持吞吐量；

[0065] S34、基于连续增长趋势的调整：当连续增长计数超过 3 次时，表明网络状况稳定良好，增大乘性增加因子 0.03 个单位，奖励持续稳定的增长模式；

[0066] S35、基于 ECN 率的调整：当 ECN 率超过每秒 50 次时，表明存在持续性拥塞，减小乘性增加因子 0.01 个单位；

[0067] S36、边界约束：将乘性增加因子限制在最小值 1.10 和最大值 1.50 之间，其中基准值为 1.25。

[0068] 进一步地，所述步骤 S4 中，融合控制策略包括拥塞响应策略和窗口增长策略：

[0069] 拥塞响应策略采用差异化窗口缩减因子：

[0070] 对于丢包类型拥塞，采用窗口保留因子 0.70，保留当前窗口的 70%；

[0071] 对于 ECN 类型拥塞，采用窗口保留因子 0.92，保留当前窗口的 92%，体现 ECN 作为早期预警信号的特点；

[0072] 对于丢失状态类型拥塞，采用窗口保留因子 0.75，保留当前窗口的 75%；

[0073] 对于其他类型拥塞，采用窗口保留因子 0.90，保留当前窗口的 90%；

[0074] 新慢启动阈值设置为新拥塞窗口与原窗口 75% 的较大值，以加速后续恢复。

[0075] 窗口增长策略根据当前窗口与慢启动阈值的关系选择不同方案：

[0076] 慢启动阶段（当前窗口小于慢启动阈值）：目标窗口为带宽延迟积的 3 倍。每次增长量为已确认段数量乘以段大小的 2 倍。当窗口低于带宽延迟积的 30% 时，增长量提升至 3 倍，加速带宽探测；

[0077] 拥塞避免阶段（当前窗口大于或等于慢启动阈值）：采用融合窗口计算公式，目标窗口等于乘性增加因子乘以带宽延迟积与当前窗口的较大值，再加上加性增加因子乘以段大小。当管道利用率（在途字节数除以当前窗口）低于 80% 时，额外增加 2 个段大小；当利用率低于 50% 时，再额外增加 4 个段大小，积极填充网络管道。

[0078] 进一步地，所述步骤 S4 中，带宽延迟积的计算和安全边界约束包括：

[0079] 带宽延迟积计算：当历史最大吞吐量和最小 RTT 均有效时，带宽延迟积等于最大吞吐量乘以最小 RTT 除以 1000000。当数据无效时，采用当前窗口的 2 倍作为默认值；

[0080] 最小窗口约束：新窗口不小于 4 倍段大小，确保传输持续进行；

[0081] 最大窗口约束：新窗口不大于带宽延迟积的 8 倍与 100 倍段大小的较大值，允许充分利用高带宽链路。

[0082] 进一步地，所述方法还包括每流独立状态管理机制，为每个 TCP 连接维护独立的状态数据结构，包括：

[0083] 历史度量缓冲区：采用固定长度循环队列存储历史数据，包括吞吐量历史队列、RTT 历史队列、窗口历史队列和带宽延迟积历史队列，用于计算统计指标和趋势分析；

[0084] ECN 事件跟踪数据：包括 ECN 事件时间戳队列、最后 ECN 事件时间和 ECN 事件率，用于判断 ECN 信号的频率和持续性；

[0085] 性能指标数据：包括观测到的最大吞吐量、指数移动平均吞吐量、最小 RTT 和最大 RTT，用于带宽延迟积估算和性能评估；

[0086] 自适应参数数据：包括当前乘性增加因子和当前加性增加因子，每流独立调整以实现差异化控制；

[0087] 状态跟踪数据：包括连续增长计数、连续减少计数、丢包计数、ECN 计数和最后丢包时间，用于趋势分析和参数调整决策。

[0088] 进一步地，所述历史度量的更新过程包括：

[0089] RTT 更新：当最近 RTT 有效时，将其加入 RTT 历史队列，并更新最小 RTT 和最大 RTT；

[0090] 吞吐量更新：当 RTT 和确认段数均有效时，计算瞬时吞吐量为确认段数乘以段大小除以 RTT（秒），更新最大吞吐量，并采用指数移动平均更新平均吞吐量，平滑因子为 0.1；

[0091] 带宽延迟积更新：当最小 RTT 和最大吞吐量均有效时，计算带宽延迟积并加入历史队列；

[0092] ECN 事件更新：当检测到 ECN 拥塞经历或 ECN 回显状态时，记录事件时间戳，更新 ECN 计数，并根据时间窗口计算 ECN 事件率。

[0093] 本发明第二方面提供一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制系统，包括：

[0094] 网络仿真模块，用于构建数据中心网络拓扑并执行离散事件仿真，模拟数据包的生成、传输、排队、标记和丢弃过程；

[0095] 拥塞控制环境模块，用于从 TCP 协议栈的关键回调点采集 15 维状态参数，构建观测空间，接收控制决策并更新 TCP 连接状态；

[0096] 智能决策模块，用于执行多信号融合拥塞检测、自适应参数调优和融合控制策略计算，输出新的慢启动阈值和拥塞窗口大小；

[0097] 进程间通信模块，用于在网络仿真进程和智能决策进程之间传递观测数据和控制动作。

[0098] 进一步地，所述网络仿真模块采用多线程并行化架构，包括：

[0099] 拓扑分区单元，用于将网络拓扑划分为多个逻辑分区，分区策略考虑通信局部性、负载均衡和同步开销；

[0100] 并行执行单元，用于为每个分区分配独立的工作线程，在各线程内串行执行事件，线程间通过同步机制协调；

[0101] 保守同步单元，用于实现时间窗口同步算法，确保跨分区事件的因果关系正确性，采用空消息机制避免死锁；

[0102] 动态负载均衡单元，用于监控各分区执行时间，通过节点迁移实现负载再平衡。

[0103] 进一步地，所述拥塞控制环境模块包括：

[0104] 观测空间定义单元，用于定义 15 维观测空间，设置各参数的取值范围和数据类型；

[0105] 状态采集单元，用于在慢启动阈值获取回调、窗口增加回调、数据包确认回调、拥塞状态变化回调和拥塞窗口事件回调等关键点采集状态参数；

[0106] ECN 状态处理单元，用于监测 ECN 状态变化，区分 ECN 触发的拥塞响应和丢包触发的拥塞响应，设置差异化的反馈信号；

[0107] 动作执行单元，用于将智能决策模块输出的控制动作应用于 TCP 连接，更新慢启动阈值和拥塞窗口大小。

[0108] 进一步地，所述进程间通信模块采用消息队列机制，包括：

[0109] 消息序列化单元，用于将观测向量序列化为结构化消息，采用高效的二进制编码格式；

[0110] 消息传输单元，用于通过本地套接字在仿真进程和决策进程之间传递消息，支持异步非阻塞通信；

[0111] 消息反序列化单元，用于将接收到的动作消息反序列化为控制参数。

[0112] 进一步地，所述智能决策模块包括：

[0113] 状态预处理单元，用于解析观测向量，提取各维度参数；

[0114] 流状态管理单元，用于维护每流独立的状态数据结构，包括历史度量、ECN 跟踪、性能指标和自适应参数；

[0115] 度量更新单元，用于根据当前观测更新流状态中的各项度量；

[0116] 统计计算单元，用于在采样窗口内计算吞吐量、RTT 和带宽延迟积的统计指标；

[0117] 拥塞检测单元，用于执行多信号融合拥塞检测，输出拥塞标志、拥塞类型和严重程度；

[0118] 参数调优单元，用于根据多因素综合分析动态调整乘性增加因子；

[0119] 窗口计算单元，用于根据融合控制策略计算目标窗口大小；

[0120] 边界约束单元，用于对计算结果施加安全边界约束。

[0121] 本发明第三方面提供一种计算机可读存储介质，其上存储有计算机程序，所述计算机程序被处理器执行时实现上述方法的步骤。

[0122] 本发明第四方面提供一种电子设备，包括处理器和存储器，存储器用于存储计算机程序，处理器执行计算机程序时实现上述方法的步骤。

[0123] 本发明的有益效果包括：

[0124] 第一，本发明提出的多信号融合拥塞检测方法，综合利用丢包信号、ECN 信号、RTT 信号和拥塞状态信号，采用分层优先级机制和频率过滤策略，在提高检测准确性的同时避免对瞬态信号的过度响应，相比单一信号检测方法具有更好的吞吐量和延迟平衡。

[0125] 第二，本发明提出的差异化拥塞响应机制，针对不同拥塞类型采用不同的窗口保留因子（丢包 0.70、ECN 0.92、丢失状态 0.75），充分区分了拥塞严重程度，使 ECN 响应比丢包响应更加温和，在保证网络稳定的同时提高了吞吐量。

[0126] 第三，本发明提出的自适应参数调优机制，根据 RTT 膨胀比、ECN 反馈、拥塞状态和增长趋势等多因素动态调整乘性增加因子，实现了控制策略对网络环境的实时适配，相比固定参数方法具有更好的自适应性。

[0127] 第四，本发明提出的融合控制策略，将基于带宽延迟积的速率控制与基于当前窗口的保守控制相结合，在慢启动阶段以 3 倍带宽延迟积为目标快速增长，在拥塞避免阶段综合考虑带宽延迟积和当前窗口，并根据管道利用率进行自适应加速，兼具速率控制的高效性和丢包控制的稳定性。

[0128] 第五，本发明提出的完整 15 维观测空间，首次将 ECN 状态、拥塞算法状态、拥塞算法事件等参数纳入状态表示，相比现有 4-6 维的状态空间提供了更全面的网络状态感知能力。

[0129] 第六，本发明提出的每流独立状态管理机制，为每个 TCP 连接维护独立的历史度量、性能指标和自适应参数，支持多流并发场景下的差异化控制，保证了流间公平性。

[0130] 第七，本发明提出的多线程并行化仿真架构，通过拓扑分区、并行执行和保守同步机制，显著提高了大规模网络仿真效率，在 8 核处理器上可实现 3-5 倍加速。

---

### 附图说明

[0131] 图 1 是本发明实施例提供的拥塞控制方法的整体流程图；

[0132] 图 2 是本发明实施例提供的多信号融合拥塞检测流程图；

[0133] 图 3 是本发明实施例提供的自适应参数调优流程图；

[0134] 图 4 是本发明实施例提供的融合控制策略计算流程图；

[0135] 图 5 是本发明实施例提供的拥塞控制系统结构图；

[0136] 图 6 是本发明实施例提供的网络仿真拓扑结构图；

[0137] 图 7 是本发明实施例提供的多线程并行化仿真架构图；

[0138] 图 8 是本发明实施例提供的智能决策模块与仿真环境交互时序图；

[0139] 图 9 是本发明实施例提供的每流状态管理数据结构图。

---

### 具体实施方式

[0140] 为使本发明的目的、技术方案和优点更加清楚，下面将结合附图和具体实施例对本发明作进一步详细描述。

#### 实施例一

[0141] 如图 1 所示，本实施例提供一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法，主要包括五个步骤。

[0142] 步骤 S1：构建多维网络状态观测空间。

[0143] 本步骤从 TCP 协议栈采集 15 个状态参数，构建完整的观测向量。这些参数全面描述了 TCP 连接的当前状态和历史信息，为后续决策提供充分的信息基础。

[0144] 观测空间的技术规格如下：观测空间维度为 15，数据类型为 64 位无符号整数，取值范围为 0 到 10 亿。

[0145] 15 个参数可分为六类：

[0146] 连接标识类参数（2 个）：参数 0 为套接字唯一标识符，取值范围为所有有效套接字句柄值，用于多流场景下的状态隔离；参数 3 为节点标识符，用于多节点仿真场景。

[0147] 时间信息参数（1 个）：参数 2 为仿真时间，单位为微秒，用于事件时间计算和频率统计。

[0148] 模式标识参数（1 个）：参数 1 为环境类型标识，值 0 表示事件驱动模式，该模式下每次 ACK 或丢包事件触发一次决策。

[0149] 窗口状态参数（2 个）：参数 4 为慢启动阈值，参数 5 为当前拥塞窗口大小，两者结合用于判断当前处于慢启动还是拥塞避免阶段。

[0150] 传输指标参数（3 个）：参数 6 为 TCP 段大小，典型值为 1448 字节（以太网 MTU 1500 减去 IP 和 TCP 头部）；参数 7 为已确认段数量，用于窗口增量计算；参数 8 为在途字节数，用于计算管道利用率。

[0151] 延迟测量参数（2 个）：参数 9 为最近 RTT，反映当前网络延迟状态；参数 10 为最小 RTT，代表网络的传播延迟基线，用于带宽延迟积估算和 RTT 膨胀检测。

[0152] 回调类型参数（1 个）：参数 11 为调用函数类型，值 0 表示慢启动阈值获取回调（GET_SS_THRESH），该回调在检测到丢包或严重拥塞时触发；值 1 表示窗口增加回调（INCREASE_WINDOW），该回调在正常 ACK 到达时触发。

[0153] 拥塞状态参数（2 个）：参数 12 为拥塞算法状态，取值定义如下：0 为 CA_OPEN（开放状态），表示正常传输无拥塞迹象；1 为 CA_DISORDER（无序状态），表示检测到乱序包或重复 ACK；2 为 CA_CWR（拥塞窗口缩减状态），表示正在响应 ECN 标记；3 为 CA_RECOVERY（恢复状态），表示正在执行快速恢复；4 为 CA_LOSS（丢失状态），表示检测到超时丢包。参数 13 为拥塞算法事件，取值定义如下：0 为 CA_EVENT_TX_START（传输开始）；1 为 CA_EVENT_CWND_RESTART（窗口重启）；2 为 CA_EVENT_COMPLETE_CWR（CWR 完成）；3 为 CA_EVENT_LOSS（丢失事件）；4 为 CA_EVENT_ECN_NO_CE（无 CE 标记）；5 为 CA_EVENT_ECN_IS_CE（有 CE 标记）；6 为 CA_EVENT_DELAYED_ACK（延迟 ACK）；7 为 CA_EVENT_NON_DELAYED_ACK（非延迟 ACK）。

[0154] ECN 状态参数（1 个）：参数 14 为显式拥塞通知状态，取值定义如下：0 为 ECN_DISABLED（ECN 禁用）；1 为 ECN_IDLE（ECN 空闲）；2 为 ECN_CE_RCVD（收到 CE 标记）；3 为 ECN_SENDING_ECE（发送 ECE）；4 为 ECN_ECE_RCVD（收到 ECE）；5 为 ECN_CWR_SENT（发送 CWR）。

[0155] 步骤 S2：执行多信号融合拥塞检测。

[0156] 如图 2 所示，本步骤基于采集的多维状态参数，综合分析多种拥塞信号，判断网络拥塞状态。本方法采用吞吐量优先的检测策略，仅响应明确的拥塞信号，避免对瞬态信号的过度反应。

[0157] 多信号融合拥塞检测的核心思想是：不同拥塞信号具有不同的可靠性和严重程度，应采用分层优先级机制进行处理，并通过频率过滤区分持续性拥塞和瞬态扰动。

[0158] 具体检测流程如下：

[0159] S21、第一优先级：显式丢包信号检测。当调用函数类型为 0 时，表示 TCP 协议栈的 GetSsThresh 函数被调用，这是丢包事件的明确指示。此时设置拥塞标志为真，拥塞类型为 loss，拥塞严重程度为 0.7。选择 0.7 而非 1.0 的设计理由是：在吞吐量优先策略下，希望在拥塞响应时保留更多窗口以加速恢复，同时仍然对丢包做出响应以保证网络稳定。同时记录丢包事件到流状态中，更新丢包计数和最后丢包时间。

[0160] S22、第二优先级：高频 ECN 信号检测。当显式拥塞通知状态为 ECN_CE_RCVD（值 2）或拥塞算法事件为 CA_EVENT_ECN_IS_CE（值 5）时，表示检测到 ECN 拥塞经历标记。但单次 ECN 事件可能是瞬态现象，不足以触发拥塞响应。因此，进一步检查 ECN 事件率。ECN 事件率的计算方法是：统计 ECN 事件队列中的事件数量，除以队列首尾时间戳的差值。当 ECN 率超过每秒 30 次时，判定发生持续性拥塞，设置拥塞标志为真，拥塞类型为 ecn，拥塞严重程度为 0.3。选择较低的严重程度值（0.3）是因为 ECN 是早期预警信号，网络尚未发生实际丢包，采用温和响应可以在保证稳定性的同时保持较高吞吐量。

[0161] S23、第三优先级：拥塞算法丢失状态检测。当拥塞算法状态为 CA_LOSS（值 4）时，表示发生了超时丢包，网络路径发生严重拥塞或故障。设置拥塞标志为真，拥塞类型为 ca_loss，拥塞严重程度为 0.6。

[0162] S24、非拥塞判定。若上述检测均未触发，判定当前网络未处于拥塞状态，返回拥塞标志为假。

[0163] 本方法有意不将以下信号作为拥塞触发条件，以实现吞吐量优先：单次 ECN 事件（可能是瞬态）、ECN 回显状态（已在高频检测中处理）、拥塞窗口缩减状态（正常 ECN 响应流程）、恢复状态（快速恢复阶段）、RTT 膨胀（测量噪声影响大）。

[0164] 步骤 S3：执行自适应参数调优。

[0165] 如图 3 所示，本步骤根据网络状态和历史趋势动态调整乘性增加因子 α。α 控制拥塞避免阶段窗口增长的激进程度，较大的 α 值带来更快的带宽探测但也增加拥塞风险。

[0166] 自适应调优的核心思想是：综合多种因素评估网络状态，在网络状况良好时采用激进策略提高吞吐量，在出现拥塞迹象时采用保守策略避免加剧拥塞。

[0167] 具体调优流程如下：

[0168] S31、RTT 膨胀比因素。RTT 膨胀比定义为最近 RTT 除以最小 RTT，反映网络中的排队延迟水平。当膨胀比小于 1.5 时，网络具有充足容量，增大 α 值 0.05 个单位并累加连续增长计数。当膨胀比在 1.5 至 2.0 之间时，存在轻度排队但网络仍在良好状态，增大 α 值 0.02 个单位。当膨胀比在 2.0 至 3.0 之间时，维持 α 不变，处于观望状态。当膨胀比超过 3.0 时，存在严重排队，减小 α 值 0.01 个单位并重置连续增长计数。设计较宽松的膨胀阈值（3.0 才减小）是吞吐量优先策略的体现。

[0169] S32、ECN 反馈因素。当检测到 ECN 拥塞经历标记或 ECN 回显状态时，减小 α 值 0.01 个单位。采用小幅度调整是因为 ECN 是早期预警，不应过度反应。不重置连续增长计数，允许在温和拥塞下继续增长。

[0170] S33、拥塞状态因素。当拥塞算法状态为 CA_LOSS 时，减小 α 值 0.01 个单位并重置连续增长计数。对于 CA_CWR 和 CA_RECOVERY 状态不进行额外调整，因为这些状态下 TCP 协议栈已在处理拥塞，额外调整可能导致过度反应。

[0171] S34、连续增长趋势因素。当连续增长计数超过 3 次时，表明近期网络状况稳定良好，增大 α 值 0.03 个单位作为正反馈奖励。

[0172] S35、ECN 率因素。当 ECN 率超过每秒 50 次时，表明存在持续性严重拥塞，减小 α 值 0.01 个单位。

[0173] S36、边界约束。将 α 限制在 1.10 至 1.50 范围内，基准值为 1.25。下界 1.10 确保窗口始终增长，上界 1.50 防止过于激进导致拥塞。

[0174] 步骤 S4：基于融合控制策略计算目标拥塞窗口大小。

[0175] 如图 4 所示，本步骤采用融合控制策略计算新的慢启动阈值和拥塞窗口大小。融合策略将基于带宽延迟积的速率控制与基于当前窗口的保守控制相结合。

[0176] 首先计算带宽延迟积 BDP。当历史最大吞吐量和最小 RTT 均有效时，BDP 等于最大吞吐量乘以最小 RTT 除以 1000000。当数据无效时，采用当前窗口的 2 倍作为默认值，这是一个激进的默认值以快速探测带宽。

[0177] 然后根据拥塞检测结果选择窗口调整策略：

[0178] 拥塞响应策略：当检测到拥塞时，根据拥塞类型选择差异化的窗口保留因子 λ。丢包类型对应 λ=0.70，新窗口为当前窗口的 70%；ECN 类型对应 λ=0.92，新窗口为当前窗口的 92%，体现 ECN 作为早期预警的特点；丢失状态类型对应 λ=0.75；其他类型对应 λ=0.90。新慢启动阈值设置为新窗口与原窗口 75% 的较大值，确保快速恢复到较高的窗口水平。同时重置连续增长计数并累加连续减少计数。

[0179] 窗口增长策略：当未检测到拥塞时，根据当前窗口与慢启动阈值的关系选择增长方案。

[0180] 在慢启动阶段（当前窗口小于慢启动阈值）：目标窗口为 3 倍 BDP。增长量为已确认段数乘以段大小的 2 倍（标准慢启动为 1 倍）。当窗口低于 BDP 的 30% 时，增长量提升至 3 倍，加速带宽探测。新窗口为当前窗口加上增长量，但不超过目标窗口。

[0181] 在拥塞避免阶段（当前窗口大于或等于慢启动阈值）：采用融合窗口计算公式。首先计算速率控制目标为 α 乘以 BDP。然后取速率控制目标与当前窗口的较大值作为基准。加上加性增量 γ 乘以段大小（γ 基准值为 4，即每 RTT 增加 4 个段）。若管道利用率低于 80%，额外增加 2 个段大小；若利用率低于 50%，再额外增加 4 个段大小。这种基于利用率的自适应增加机制可以在网络未充分利用时积极填充管道。

[0182] 最后应用安全边界约束：最小窗口为 4 倍段大小，最大窗口为 8 倍 BDP 与 100 倍段大小的较大值。新窗口被约束在最小和最大值之间。

[0183] 步骤 S5：输出动作并更新 TCP 连接状态。

[0184] 将计算得到的新慢启动阈值和新拥塞窗口大小组成动作向量，通过进程间通信接口传递给网络仿真环境，由 TCP 协议栈应用这些新值。

[0185] 动作空间的技术规格如下：动作空间维度为 2，数据类型为 32 位无符号整数，动作索引 0 为新慢启动阈值（字节），动作索引 1 为新拥塞窗口大小（字节）。

#### 实施例二

[0186] 如图 5 所示，本实施例提供一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制系统，包括四个主要模块。

[0187] 网络仿真模块采用 ns-3 离散事件网络仿真器，支持完整的 TCP/IP 协议栈和 ECN 机制。仿真模块负责构建网络拓扑、生成流量负载、执行数据包传输仿真、收集性能统计。

[0188] 如图 6 所示，本实施例采用哑铃型拓扑进行仿真验证。拓扑包括左侧叶子节点（发送端）、右侧叶子节点（接收端）、左侧路由器和右侧路由器。接入链路连接叶子节点与路由器，带宽为 10Gbps，延迟为 2 微秒。瓶颈链路连接两个路由器，带宽为 2Gbps，延迟为 5 微秒。路由器配置 RED 队列管理和 ECN 标记功能。

[0189] 如图 7 所示，网络仿真模块采用多线程并行化架构。主要组件包括：

[0190] 拓扑分区单元：将网络拓扑划分为多个逻辑分区。分区策略遵循以下原则：通信频繁的节点划入同一分区以减少跨分区同步开销；各分区计算负载大致均衡；分区边界切割的链路数量最小化。典型的分区方案是将每个发送-接收节点对及其关联路由器划为一个分区。

[0191] 并行执行单元：为每个分区分配独立的工作线程，在各线程内按时间顺序串行执行事件。线程数量可配置，默认等于 CPU 核心数。

[0192] 保守同步单元：采用时间窗口同步算法协调线程间的事件执行。所有线程在同一时间窗口内并行执行，窗口结束时进行全局同步。跨分区的数据包传输通过消息传递机制处理。采用空消息机制避免死锁。

[0193] 动态负载均衡单元：监控各分区的执行时间，当检测到负载不均衡时，通过节点迁移进行调整。

[0194] 通过多线程并行化，仿真速度在 8 核处理器上可提升 3-5 倍，显著缩短大规模仿真的执行时间。

[0195] 拥塞控制环境模块是连接网络仿真和智能决策的桥梁，负责状态采集和动作执行。

[0196] 观测空间定义单元定义了 15 维观测空间，各维度的数据类型、取值范围和语义如实施例一所述。

[0197] 状态采集单元在 TCP 协议栈的以下回调点采集状态：GetSsThresh 回调在检测到丢包需要更新慢启动阈值时触发，设置调用函数类型为 0；IncreaseWindow 回调在收到正常 ACK 需要增加窗口时触发，设置调用函数类型为 1；PktsAcked 回调在数据包被确认时触发，采集 RTT 测量和确认段数；CongestionStateSet 回调在拥塞状态变化时触发，采集新的拥塞状态；CwndEvent 回调在拥塞窗口事件发生时触发，采集 ECN 相关事件。

[0198] ECN 状态处理单元监测 ECN 状态变化，区分 ECN 触发的拥塞响应和丢包触发的拥塞响应。在 GetSsThresh 回调中，检查 ECN 状态是否为 ECN_CE_RCVD 或 ECN_ECE_RCVD，若是则标记为 ECN 触发的拥塞。

[0199] 动作执行单元接收智能决策模块的输出，将新的慢启动阈值和拥塞窗口大小写入 TCP 控制块，完成状态更新。

[0200] 如图 8 所示，智能决策模块与仿真环境的交互流程如下：

[0201] 步骤 1：仿真环境初始化，创建通信接口，等待决策进程连接。

[0202] 步骤 2：决策进程连接到通信接口，获取观测空间和动作空间定义。

[0203] 步骤 3：仿真开始执行。当 TCP 协议栈触发拥塞控制回调时，环境模块采集当前状态构建观测向量，通过通信接口发送给决策进程。决策进程执行多信号融合拥塞检测、自适应参数调优和融合控制策略计算，返回动作。环境模块应用动作更新 TCP 连接状态。

[0204] 步骤 4：重复步骤 3 直到仿真结束。

[0205] 步骤 5：仿真环境通知决策进程结束，关闭连接。

[0206] 进程间通信模块采用本地套接字和结构化消息实现高效通信。消息格式采用 Protocol Buffers 定义，包括观测消息、动作消息、空间定义消息等。消息序列化和反序列化使用高效的二进制编码。

#### 实施例三

[0207] 如图 9 所示，本实施例详细说明每流独立状态管理机制的实现。

[0208] 在多流并发场景下，每个 TCP 连接需要独立的状态管理以实现差异化控制。智能决策模块维护一个以套接字标识符为键的状态字典，每个流的状态包含以下数据结构：

[0209] 历史度量缓冲区采用固定长度循环队列实现，最大长度为 100：

[0210] 吞吐量历史队列：存储最近 100 次的瞬时吞吐量测量值，用于计算最大吞吐量和平均吞吐量。

[0211] RTT 历史队列：存储最近 100 次的 RTT 测量值，用于计算 RTT 统计指标和检测 RTT 膨胀。

[0212] 窗口历史队列：存储最近 100 次的窗口大小，用于分析窗口变化趋势。

[0213] BDP 历史队列：存储最近 100 次的带宽延迟积估计值，用于计算平均 BDP。

[0214] ECN 事件跟踪数据：

[0215] ECN 事件时间戳队列：固定长度 50 的循环队列，存储最近 ECN 事件的时间戳。

[0216] 最后 ECN 事件时间：记录最近一次 ECN 事件的时间戳。

[0217] ECN 事件率：根据事件队列计算的每秒事件数。

[0218] 性能指标数据：

[0219] 最大吞吐量：观测到的峰值吞吐量，单位为字节每秒。

[0220] 平均吞吐量：采用指数移动平均计算的平均吞吐量，平滑因子为 0.1。

[0221] 最小 RTT：观测到的最小 RTT，初始值为无穷大。

[0222] 最大 RTT：观测到的最大 RTT，初始值为 0。

[0223] 自适应参数数据：

[0224] 当前乘性增加因子 α：初始值为 1.25，范围 1.10-1.50。

[0225] 当前加性增加因子 γ：初始值为 4.0。

[0226] 状态跟踪数据：

[0227] 连续增长计数：记录连续窗口增长的次数，用于趋势奖励。

[0228] 连续减少计数：记录连续窗口减少的次数。

[0229] 丢包计数：累计丢包事件数。

[0230] ECN 计数：累计 ECN 事件数。

[0231] 最后丢包时间：最近一次丢包事件的时间戳。

[0232] 流状态的更新在每次收到观测时执行，具体包括：

[0233] RTT 更新：若最近 RTT 有效（大于 0），加入 RTT 历史队列，更新最小最大 RTT。

[0234] 吞吐量更新：若 RTT 和确认段数均有效，计算瞬时吞吐量（确认段数乘以段大小除以 RTT 秒数），加入吞吐量历史队列，更新最大吞吐量，采用 EMA 更新平均吞吐量。

[0235] 窗口更新：将当前窗口加入窗口历史队列。

[0236] BDP 更新：若最小 RTT 和最大吞吐量均有效，计算 BDP 并加入历史队列。

[0237] ECN 更新：若检测到 ECN_CE_RCVD 或 ECN_ECE_RCVD 状态，记录时间戳，更新 ECN 计数，计算 ECN 率。

[0238] 统计计算使用最近 40 个样本（2 倍采样窗口大小），计算吞吐量的最大值和平均值、RTT 的最小值最大值平均值、BDP 的平均值。

---

### 权利要求书

1. 一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法，其特征在于，包括以下步骤：

S1、构建多维网络状态观测空间，从 TCP 协议栈采集包含 15 个参数的状态向量，所述参数涵盖连接标识、时间信息、窗口状态、传输指标、延迟测量、回调类型、拥塞状态和显式拥塞通知状态；

S2、基于所述多维状态参数，执行多信号融合拥塞检测，综合分析丢包信号、显式拥塞通知信号、拥塞控制状态信号和拥塞事件信号，判断网络拥塞状态并量化拥塞严重程度；

S3、根据拥塞检测结果和历史性能数据，执行自适应参数调优，动态调整乘性增加因子，实现控制策略对网络环境的实时适配；

S4、采用融合控制策略计算目标拥塞窗口大小，所述融合控制策略将基于带宽延迟积的速率控制与基于当前窗口的保守控制相结合，根据拥塞类型采用差异化的窗口调整策略；

S5、输出新的慢启动阈值和拥塞窗口大小，更新 TCP 连接的传输参数。

2. 根据权利要求 1 所述的方法，其特征在于，所述步骤 S2 中，多信号融合拥塞检测采用分层优先级机制，包括：

第一优先级检测显式丢包信号：当调用函数类型为慢启动阈值获取时，判定发生丢包，拥塞严重程度为 0.7；

第二优先级检测高频 ECN 信号：当 ECN 事件率超过预设阈值时，判定发生持续性拥塞，拥塞严重程度为 0.3；

第三优先级检测拥塞算法丢失状态：当拥塞算法状态为丢失状态时，判定发生超时丢包，拥塞严重程度为 0.6；

单次 ECN 事件、ECN 回显状态、拥塞窗口缩减状态、恢复状态和往返时延膨胀不作为拥塞触发条件。

3. 根据权利要求 1 所述的方法，其特征在于，所述步骤 S3 中，自适应参数调优采用多因素综合调整机制，包括：

基于 RTT 膨胀比调整：当 RTT 膨胀比小于第一阈值时增大乘性增加因子，当 RTT 膨胀比大于第二阈值时减小乘性增加因子；

基于 ECN 反馈调整：当检测到 ECN 拥塞经历标记时，减小乘性增加因子；

基于拥塞状态调整：当拥塞算法状态为丢失状态时，减小乘性增加因子；

基于连续增长趋势调整：当连续增长计数超过预设次数时，增大乘性增加因子；

将乘性增加因子限制在预设的最小值和最大值之间。

4. 根据权利要求 1 所述的方法，其特征在于，所述步骤 S4 中，在拥塞状态下采用差异化窗口保留因子：

丢包类型对应窗口保留因子为 0.70；

ECN 类型对应窗口保留因子为 0.92；

丢失状态类型对应窗口保留因子为 0.75；

新慢启动阈值设置为新窗口与原窗口预设比例的较大值。

5. 根据权利要求 1 所述的方法，其特征在于，所述步骤 S4 中，在非拥塞状态下的窗口增长策略包括：

慢启动阶段：目标窗口为带宽延迟积的预设倍数，当窗口低于带宽延迟积的预设比例时采用更激进的增长策略；

拥塞避免阶段：目标窗口为乘性增加因子乘以带宽延迟积与当前窗口的较大值，再加上加性增加因子乘以段大小；当管道利用率低于预设阈值时，额外增加窗口增量。

6. 根据权利要求 1 所述的方法，其特征在于，还包括每流独立状态管理机制，为每个 TCP 连接维护独立的状态数据结构，包括：

历史度量缓冲区：采用循环队列存储吞吐量历史、RTT 历史、窗口历史和带宽延迟积历史；

ECN 事件跟踪数据：包括 ECN 事件时间戳队列和 ECN 事件率；

性能指标数据：包括最大吞吐量、平均吞吐量、最小 RTT 和最大 RTT；

自适应参数数据：包括当前乘性增加因子。

7. 一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制系统，其特征在于，包括：

网络仿真模块，用于构建网络拓扑并执行离散事件仿真，模拟数据包的传输过程；

拥塞控制环境模块，用于从 TCP 协议栈采集多维状态参数，构建观测空间，并将控制决策应用于 TCP 连接；

智能决策模块，用于执行多信号融合拥塞检测、自适应参数调优和融合控制策略计算，输出新的慢启动阈值和拥塞窗口大小；

进程间通信模块，用于在网络仿真模块和智能决策模块之间传递数据。

8. 根据权利要求 7 所述的系统，其特征在于，所述网络仿真模块采用多线程并行化架构，包括：

拓扑分区单元，用于将网络拓扑划分为多个逻辑分区；

并行执行单元，用于在多个线程上并行执行各分区的仿真事件；

保守同步单元，用于协调线程间的事件同步；

动态负载均衡单元，用于调整各分区的负载分配。

9. 根据权利要求 7 所述的系统，其特征在于，所述拥塞控制环境模块包括：

观测空间定义单元，用于定义包含 15 个参数的观测空间；

状态采集单元，用于在 TCP 协议栈的回调点采集状态参数；

ECN 状态处理单元，用于区分 ECN 触发的拥塞响应和丢包触发的拥塞响应；

动作执行单元，用于将控制决策应用于 TCP 连接。

10. 一种计算机可读存储介质，其上存储有计算机程序，其特征在于，所述计算机程序被处理器执行时实现权利要求 1 至 6 任一项所述方法的步骤。

---

### 说明书摘要

本发明公开了一种基于多信号融合与自适应参数调优的数据中心网络拥塞控制方法及系统。该方法包括：构建包含 15 个参数的多维网络状态观测空间；执行多信号融合拥塞检测，采用分层优先级机制综合分析丢包、ECN、拥塞状态等信号，通过频率过滤区分持续性拥塞和瞬态扰动；执行自适应参数调优，根据 RTT 膨胀比、ECN 反馈、拥塞状态和增长趋势动态调整乘性增加因子；采用融合控制策略计算目标窗口，将速率控制与窗口控制相结合，针对不同拥塞类型采用差异化窗口保留因子。本发明通过吞吐量优先的检测策略和差异化响应机制，在保证网络稳定性的同时实现了较高吞吐量，并通过多线程并行化仿真架构加速算法验证。

### 摘要附图

图 1
